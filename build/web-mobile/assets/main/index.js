System.register("chunks:///_virtual/GameCOntroller.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,i,o,s,n,a,l,h,c,d,u,f,g,p,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,n=e._decorator,a=e.SpriteFrame,l=e.Node,h=e.Label,c=e.Graphics,d=e.Sprite,u=e.Color,f=e.tween,g=e.Vec3,p=e.Component,m=e.Button}],execute:function(){var v,b,w,B,S,y,C,L,E,G,z,_,H,P,T;s._RF.push({},"49135PoNj1EormW5G5X3BbL","GameCOntroller",void 0);var R=n.ccclass,F=n.property;e("GameController",(v=R("GameController"),b=F({type:[a]}),w=F(l),B=F(h),S=F(h),y=F(h),C=F(c),v((G=t((E=function(e){function t(){for(var t,r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return t=e.call.apply(e,[this].concat(s))||this,i(t,"iconFrames",G,o(t)),i(t,"gameBoard",z,o(t)),i(t,"statusLabel",_,o(t)),i(t,"scoreLabel",H,o(t)),i(t,"timeLabel",P,o(t)),i(t,"lineRenderer",T,o(t)),t.rows=8,t.cols=8,t.gridSize=70,t.board=[],t.selected=[],t.score=0,t.timeElapsed=0,t.timerInterval=null,t.highlightGraphics={},t}r(t,e);var s=t.prototype;return s.start=function(){this.initBoard(),this.generateGrids(),this.renderBoard(),this.updateStatus("ç‚¹å‡»ä¸€ä¸ªå›¾æ ‡ï¼Œå†é€‰æ‹©å¦ä¸€ä¸ªç›¸åŒå›¾æ ‡è¿›è¡Œè¿žæŽ¥"),this.updateScore(0),this.startTime()},s.initBoard=function(){var e=this,t=this.rows*this.cols;if(t%2==0){for(var r=t/2,i=this.iconFrames.length,o=[],s=0;s<r;s++)o.push(s%i);o=[].concat(o,o),this.shuffle(o),this.board=Array(this.rows).fill(null).map((function(){return Array(e.cols).fill(-1)}));for(var n=0,a=0;a<this.rows;a++)for(var l=0;l<this.cols;l++)this.board[a][l]=o[n++]}else console.error("æ£‹ç›˜æ ¼å­æ•°å¿…é¡»ä¸ºå¶æ•°")},s.generateGrids=function(){var e=this;this.gameBoard.removeAllChildren();for(var t=.5*this.gridSize,r=function(r){for(var i=function(i){var o=new l("tile_"+r+"_"+i);o.addComponent(d);var s=o.addComponent(m);s.transition=m.Transition.SCALE,s.zoomScale=.95,o.setPosition(i*e.gridSize-e.cols*t+t,-r*e.gridSize+e.rows*t-t),o.on(m.EventType.CLICK,(function(){e.onTileClick(r,i)}),e),e.gameBoard.addChild(o)},o=0;o<e.cols;o++)i(o)},i=0;i<this.rows;i++)r(i)},s.renderBoard=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++){var r=this.gameBoard.getChildByName("tile_"+e+"_"+t);if(r){var i=r.getComponent(d),o=this.board[e][t];i.spriteFrame=-1===o?null:this.iconFrames[o]}}},s.addHighlightBorder=function(e,t){var r=this.gameBoard.getChildByName("tile_"+e+"_"+t);if(r&&!this.highlightGraphics[e+","+t]){var i=new l("border"),o=i.addComponent(c);r.addChild(i),i.setPosition(0,0);o.lineWidth=4,o.strokeColor=u.YELLOW.fromHEX("#ffff00"),o.rect(-34,-34,68,68),o.stroke(),this.highlightGraphics[e+","+t]=o,r.setScale(1.1,1.1,1)}},s.removeHighlightBorder=function(e,t){var r=this.gameBoard.getChildByName("tile_"+e+"_"+t);if(r){var i=e+","+t;if(this.highlightGraphics[i])this.highlightGraphics[i].node.destroy(),delete this.highlightGraphics[i];r.setScale(1,1,1)}},s.clearAllHighlightBorders=function(){for(var e in this.highlightGraphics){var t=e.split(",").map(Number),r=t[0],i=t[1];this.removeHighlightBorder(r,i)}},s.onTileClick=function(e,t){var r=this;if(-1!==this.board[e][t])if(0===this.selected.length)this.selected.push({row:e,col:t}),this.addHighlightBorder(e,t),this.updateStatus("é€‰æ‹©ç¬¬äºŒä¸ªç›¸åŒå›¾æ ‡");else if(1===this.selected.length){var i=this.selected[0];if(i.row===e&&i.col===t)return this.removeHighlightBorder(e,t),this.selected=[],void this.updateStatus("ç‚¹å‡»ä¸€ä¸ªå›¾æ ‡å¼€å§‹");if(this.selected.push({row:e,col:t}),this.addHighlightBorder(e,t),this.board[i.row][i.col]!==this.board[e][t])return this.showError("âŒ ä¸æ˜¯ç›¸åŒçš„å›¾æ ‡ï¼"),this.updateScore(this.score-1),void this.delayClearSelection();var o=this.findConnectionPath(i.row,i.col,e,t);o?(this.drawFullPath(o),this.scheduleOnce((function(){r.removePair(i.row,i.col,e,t)}),.4)):(this.showError("ðŸš« è·¯å¾„è¢«é˜»æŒ¡æˆ–æ‹ç‚¹è¿‡å¤šï¼"),this.updateScore(this.score-1),this.delayClearSelection())}},s.findConnectionPath=function(e,t,r,i){if(e===r&&t===i)return null;if(this.board[e][t]!==this.board[r][i])return null;var o=[[-1,0],[1,0],[0,-1],[0,1]],s=[],n=new Set;for(s.push({r:e,c:t,turns:-1,dir:-1,path:[{r:e,c:t}]}),n.add(e+","+t+",-1");s.length>0;){var a=s.shift(),l=a.r,h=a.c,c=a.turns,d=a.dir,u=a.path;if(!(c>2))for(var f=0;f<o.length;f++){var g=o[f],p=g[0],m=g[1],v=l+p,b=h+m,w=c;if(-1!==d&&d!==f&&w++,!(w>2))for(;v>=0&&v<this.rows&&b>=0&&b<this.cols&&(-1===this.board[v][b]||v===r&&b===i);){var B=v+","+b+","+w;if(!n.has(B)){n.add(B);var S=[].concat(u),y=S[S.length-1];if(y.r===v&&y.c===b||S.push({r:v,c:b}),s.push({r:v,c:b,turns:w,dir:f,path:S}),v===r&&b===i)return S}v+=p,b+=m}}}return null},s.drawFullPath=function(e){var t=this;if(this.lineRenderer&&e&&!(e.length<2)){this.lineRenderer.clear();var r,i=e.length-2;r=i<=0?u.GREEN.fromHEX("#00ff00"):1===i?u.YELLOW.fromHEX("#ffff00"):u.BLUE.fromHEX("#ffa500"),this.lineRenderer.lineWidth=6,this.lineRenderer.strokeColor=r;var o=e[0],s=this.getGridWorldPosition(o.r,o.c);this.lineRenderer.moveTo(s.x,s.y);for(var n=1;n<e.length;n++){var a=e[n],l=this.getGridWorldPosition(a.r,a.c);this.lineRenderer.lineTo(l.x,l.y)}this.lineRenderer.stroke(),this.scheduleOnce((function(){t.lineRenderer.clear()}),.8)}},s.getGridWorldPosition=function(e,t){var r=.5*this.gridSize;return{x:t*this.gridSize-this.cols*r+r,y:-e*this.gridSize+this.rows*r-r}},s.removePair=function(e,t,r,i){var o=this;this.removeHighlightBorder(e,t),this.removeHighlightBorder(r,i),this.selected=[],this.board[e][t]=-1,this.board[r][i]=-1,this.updateScore(this.score+10);var s=this.gameBoard.getChildByName("tile_"+e+"_"+t),n=this.gameBoard.getChildByName("tile_"+r+"_"+i);f(s).to(.2,{scale:new g(.05,.05,1)}).call((function(){o.renderBoard(),o.checkWin()?(o.stopTime(),o.updateStatus("ðŸŽ‰ æ­å–œé€šå…³ï¼"),o.updateScore(o.score+50)):o.updateStatus("ç»§ç»­æ¶ˆé™¤å§ï¼")})).start(),f(n).to(.2,{scale:new g(.05,.05,1)}).start()},s.checkWin=function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.cols;t++)if(-1!==this.board[e][t])return!1;return!0},s.updateStatus=function(e){this.statusLabel&&(this.statusLabel.string=e)},s.showError=function(e){this.updateStatus(e)},s.delayClearSelection=function(){var e=this;this.scheduleOnce((function(){e.clearAllHighlightBorders(),e.selected=[],e.updateStatus("ç‚¹å‡»ä¸€ä¸ªå›¾æ ‡å¼€å§‹")}),.6)},s.shuffle=function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),i=[e[r],e[t]];e[t]=i[0],e[r]=i[1]}},s.updateScore=function(e){this.score=e,this.scoreLabel&&(this.scoreLabel.string="åˆ†æ•°ï¼š"+this.score)},s.updateTime=function(){this.timeElapsed++,this.timeLabel&&(this.timeLabel.string="æ—¶é—´ï¼š"+this.timeElapsed+"s")},s.startTime=function(){var e=this;this.timeElapsed=0,this.updateTime(),this.timerInterval=setInterval((function(){e.updateTime()}),1e3)},s.stopTime=function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},t}(p)).prototype,"iconFrames",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=t(E.prototype,"gameBoard",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(E.prototype,"statusLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(E.prototype,"scoreLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=t(E.prototype,"timeLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(E.prototype,"lineRenderer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=E))||L));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./GameCOntroller.ts"],(function(){return{setters:[null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});